---
import { loadCategoriesConfig } from '../../../headless/store/services/category-service';

// Redirect to the first category (typically "All Products") for consistent URL structure
const categoriesConfig = await loadCategoriesConfig();
const firstCategory = categoriesConfig.categories[0];

if (!firstCategory) {
  throw new Error('No categories found');
}

// Use the real category slug from Wix API
if (!firstCategory.slug) {
  throw new Error(`Category "${firstCategory.name}" has no slug`);
}

const categorySlug = firstCategory.slug;
const redirectUrl = `/store/example-2/category/${categorySlug}${Astro.url.search}`;
return Astro.redirect(redirectUrl);
---
